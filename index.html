<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>D√©fis entre potes - Jetons</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body, html { margin:0; padding:0; font-family: 'Roboto', sans-serif; background:#0f0f0f; color:white; text-align:center;}
  header {padding:50px 20px; background:#111;}
  h1 {font-size:3em; color:#00ff88;}
  p {font-size:1.2em; opacity:0.9;}
  .btn {display:inline-block; padding:20px 40px; background:#00ff88; color:black; font-weight:bold; border-radius:30px; font-size:20px; margin-top:20px; transition: transform 0.2s;}
  .btn:hover {transform:scale(1.1);}
  .tokens {margin-top:30px; font-size:1.5em;}
  .countdown {margin-top:10px; font-size:1.2em; opacity:0.8;}
</style>
</head>
<body>

<header>
  <h1>üî• D√©fis entre potes</h1>
  <p>Utilise tes jetons pour cr√©er un d√©fi chaque jour !</p>
  <button class="btn" id="createChallenge">‚ûï Cr√©er un d√©fi</button>
  <div class="tokens">Jetons restants : <span id="tokens">5</span></div>
  <div class="countdown">Nouveaux jetons dans : <span id="timer">24:00:00</span></div>
</header>

<script>
  // --- INITIALISATION ---
  const maxTokens = 5;
  const tokenResetTime = 24*60*60*1000; // 24h en ms
  let tokens = localStorage.getItem('tokens');
  let lastReset = localStorage.getItem('lastReset');

  if(!tokens) tokens = maxTokens;
  if(!lastReset) lastReset = new Date().getTime();

  tokens = parseInt(tokens);
  lastReset = parseInt(lastReset);

  const tokensSpan = document.getElementById('tokens');
  const timerSpan = document.getElementById('timer');
  const button = document.getElementById('createChallenge');

  function updateUI(){
    tokensSpan.textContent = tokens;
    if(tokens <=0) {
      button.disabled = true;
      button.style.opacity = 0.5;
    } else {
      button.disabled = false;
      button.style.opacity = 1;
    }
  }

  function formatTime(ms){
    const totalSeconds = Math.floor(ms/1000);
    const h = String(Math.floor(totalSeconds/3600)).padStart(2,'0');
    const m = String(Math.floor((totalSeconds%3600)/60)).padStart(2,'0');
    const s = String(totalSeconds%60).padStart(2,'0');
    return `${h}:${m}:${s}`;
  }

  function checkReset(){
    const now = new Date().getTime();
    if(now - lastReset >= tokenResetTime){
      tokens = maxTokens;
      lastReset = now;
      localStorage.setItem('tokens', tokens);
      localStorage.setItem('lastReset', lastReset);
    }
  }

  function updateCountdown(){
    const now = new Date().getTime();
    let diff = tokenResetTime - (now - lastReset);
    if(diff<0) diff =0;
    timerSpan.textContent = formatTime(diff);
  }

  button.addEventListener('click', ()=>{
    if(tokens>0){
      tokens--;
      localStorage.setItem('tokens', tokens);
      // Ouvre le Google Form
      window.open('https://forms.gle/9FCERFqSMgXZnyeq8', '_blank');
      updateUI();
    }
  });

  // --- LOOP ---
  setInterval(()=>{
    checkReset();
    updateUI();
    updateCountdown();
  },1000);

  // initial UI update
  updateUI();
  updateCountdown();

</script>

</body>
</html>
